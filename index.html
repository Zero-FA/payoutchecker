<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Apex PA Payout Checker</title>
<link rel="icon" href="data:,">
<style>
  :root{
    --bg:#0b1220; --card:#0f172a; --ink:#e5e7eb; --muted:#94a3b8; --line:#1f2937;
    --good:#22c55e; --good2:#16a34a; --bad:#f43f5e; --pill:#10b98133;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    background:linear-gradient(180deg,#0b1220,#0a0f1a 28%,#0b1220);
    color:var(--ink);
    font:14px/1.5 system-ui,Segoe UI,Roboto,Helvetica,Arial
  }
  .wrap{max-width:1100px;margin:32px auto;padding:0 16px}
  .h1{font-weight:800;font-size:24px;margin-bottom:4px}
  .sub{color:var(--muted);margin-bottom:4px}
  .card{
    background:rgba(15,23,42,.95);
    border:1px solid var(--line);
    border-radius:16px;
    padding:16px
  }
  .grid{display:grid;gap:12px}
  .cols2{grid-template-columns:1fr 1fr}
  .cols3{grid-template-columns:2fr 1fr}
  .label{font-size:12px;color:var(--muted);margin-bottom:6px}
  .input,.select{
    width:100%;
    border:1px solid #243143;
    background:#0b1527;
    color:var(--ink);
    border-radius:10px;
    padding:10px 12px;
    font:inherit
  }
  .help{font-size:12px;color:var(--muted);margin-top:4px}
  .row{display:flex;gap:8px;align-items:center}
  .ok{color:var(--good)}
  .bad{color:var(--bad)}
  .tile{
    background:#0c162b;
    border:1px solid #1f2c46;
    border-radius:12px;
    padding:12px
  }
  .range{
    background:#06331f;
    border:1px solid #144f33;
    color:#a7f3d0;
    border-radius:12px;
    padding:12px
  }
  .list{list-style:none;padding:0;margin:0}
  .list li{
    display:flex;
    gap:8px;
    align-items:flex-start;
    padding:6px 0;
    border-bottom:1px solid #142036
  }
  .list li:last-child{border-bottom:0}
  .mono{font:12px ui-monospace,Consolas,Menlo,monospace}
  hr{border:none;border-top:1px solid #1a2234;margin:12px 0}
  @media (max-width:920px){
    .cols3,.cols2{grid-template-columns:1fr}
  }
  svg{flex:0 0 auto}
</style>
</head>
<body>
<div class="wrap">
  <div class="h1">Zero's Apex Trader Funding Payout Checker</div>
  <div class="sub">Check your payout eligibility criteria.</div>
  <div style="color:#64748b;font-size:12px;margin-top:-2px;margin-bottom:10px;">
    This tool is unofficial and for guidance only; final decisions are made by Apex Trader Funding.
  </div>

  <div style="margin:8px 0 12px 0; text-align:right;">
    <a href="https://apextraderfunding.com/member/aff/go/seanodonoghue67"
       target="_blank"
       style="
         display:inline-block;
         padding:8px 14px;
         background:#0c162b;
         border:1px solid #1f2c46;
         border-radius:8px;
         color:#60a5fa;
         font-weight:600;
         font-size:13px;
         text-decoration:none;
       ">
       Use code ZEROFA at checkout! →
    </a>
  </div>

  <!-- MAIN GRID -->
  <div class="grid cols3" style="gap:16px; align-items:start">

    <!-- LEFT (Form + What to Fix) -->
    <div class="grid" style="gap:16px">
      <div class="card">
        <div class="grid cols2">
          <div>
            <div class="label">PA Status</div>
            <select id="paStatus" class="select">
              <option>Active</option>
              <option>Account Blown</option>
              <option>Failed Rebill</option>
              <option>Invoice Cancelled</option>
            </select>
          </div>
          <div>
            <div class="label">Account Size</div>
            <select id="account" class="select">
              <option value="25k">$25k</option>
              <option value="50k" selected>$50k</option>
              <option value="100k">$100k</option>
              <option value="150k">$150k</option>
              <option value="250k">$250k</option>
              <option value="300k">$300k</option>
              <option value="100kStatic">$100k Static</option>
            </select>
          </div>

          <div>
            <div class="label">Approved Payouts So Far</div>
            <input id="approvedCount" class="input" type="number" min="0" placeholder="e.g., 0" />
            <div class="help">
              Enter how many payouts have already been <b>approved</b>.
              The 4th drops the safety net. The 6th removes the 30% rule and caps.
            </div>
          </div>

          <div>
            <div class="label">Last Payout Status</div>
            <select id="payoutStatus" class="select">
              <option value="none">None yet</option>
              <option value="approved">Approved</option>
              <option value="denied">Denied</option>
            </select>
            <div id="payoutStatusHelp" class="help">
              All trading days since starting this PA count toward eligibility.
            </div>
          </div>

          <div class="row" style="padding-top:28px">
            <input id="isLiveProp" type="checkbox" />
            <label for="isLiveProp">Live Prop Account (lifts 30% rule)</label>
          </div>
        </div>

        <hr />

        <div class="grid cols2">
          <div>
            <div class="label">Current Balance ($)</div>
            <input id="currentBalance" class="input" inputmode="decimal" placeholder="e.g., 52600" />
          </div>
          <div>
            <div class="label">Desired Payout ($)</div>
            <input id="requestedPayout" class="input" inputmode="decimal" placeholder="e.g., 500" />
            <div class="help">Min $500. Caps apply for first 5 payouts.</div>
          </div>

          <div>
            <div class="label">Highest Profit Day Since Last Approval</div>
            <input id="highestProfitDay" class="input" inputmode="decimal" placeholder="e.g., 600" />
          </div>
          <div>
            <div class="label">Trading Days Since Last Request</div>
            <input id="tradingDays" class="input" type="number" min="0" placeholder="e.g., 8" />
          </div>
          <div>
            <div class="label">Profitable Days ≥ $50 Since Last Approval/Denial</div>
            <input id="profitableDays" class="input" type="number" min="0" placeholder="e.g., 5" />
          </div>
        </div>
      </div>

      <!-- What to Fix -->
      <div id="adviceWrap" class="card" style="display:none">
        <div style="font-weight:600;margin-bottom:6px">What to Fix</div>
        <ul id="adviceList" class="list"></ul>
      </div>
    </div>

    <!-- RIGHT (Summary + Checklist + Trading Rules) -->
    <div class="grid" style="gap:16px">
      <!-- Summary + Checklist merged into one tall card -->
      <div id="summaryCard" class="card" style="border-color:#144f33">
        <div class="row">
          <svg class="ok" width="22" height="22" viewBox="0 0 24 24" fill="none"
               stroke="currentColor" stroke-width="2">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
            <path d="M22 4 12 14.01l-3-3"></path>
          </svg>
          <div style="font-weight:700">Should the payout be approved?</div>
        </div>
        <div style="text-align:right;margin-top:2px;">
          <a href="https://support.apextraderfunding.com/hc/en-us/articles/40507212951451-PA-Payout-Parameters"
             target="_blank"
             style="font-size:12px;color:#60a5fa;text-decoration:none;">
             View Payout Parameters →
          </a>
        </div>

        <div id="yesno" style="font-size:22px;font-weight:800;margin:6px 0" class="ok">YES</div>

        <div class="grid cols2">
          <div class="tile">
            <div class="help">Safety net required?</div>
            <div id="safetyReq" style="font-weight:600">—</div>
            <div class="help">Safety net = drawdown + $100 → <span id="safetyAmt">—</span></div>
          </div>
          <div class="tile">
            <div class="help">Min balance to request</div>
            <div id="minBal" style="font-weight:600">—</div>
            <div class="help">Must remain after payout (≥4th) or be met before request (≤3rd).</div>
          </div>
          <div class="tile">
            <div class="help">Min payout</div>
            <div id="minPay" style="font-weight:600">$500</div>
          </div>
          <div class="tile">
            <div class="help">Max payout cap</div>
            <div id="maxCap" style="font-weight:600">—</div>
          </div>
        </div>

        <div id="rangeWrap" class="range" style="margin-top:12px;display:none">
          <div class="help">Allowed payout range</div>
          <div id="range" style="font-weight:700;font-size:16px">$— – $—</div>
        </div>

        <hr style="margin:14px 0 10px 0">

        <!-- Checklist now inside the same card -->
        <div style="font-weight:600;margin-bottom:6px">Checklist</div>
        <ul id="checklist" class="list"></ul>
      </div>

      <!-- Trading Rule Compliance With Checkboxes + Links -->
      <div class="card">
        <div style="font-weight:600;margin-bottom:6px">Trading Rule Compliance (Required)</div>
        <ul id="rulesList" class="list"></ul>
      </div>

      <div class="card mono" style="font-size:12px;color:var(--muted)">
        Notes: Trading rules MUST be followed to qualify for payout.
        This tool is an estimator only and does not guarantee approval.
      </div>
    </div>

  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
/* ---------- Data & Helpers ---------- */
const ACCOUNT_CONFIG = {
  "25k": { label:"$25k", startBalance:25000, minReqBalanceFirst3:26600 },
  "50k": { label:"$50k", startBalance:50000, minReqBalanceFirst3:52600 },
  "100k":{ label:"$100k", startBalance:100000, minReqBalanceFirst3:103100 },
  "150k":{ label:"$150k", startBalance:150000, minReqBalanceFirst3:155100 },
  "250k":{ label:"$250k", startBalance:250000, minReqBalanceFirst3:256600 },
  "300k":{ label:"$300k", startBalance:300000, minReqBalanceFirst3:307600 },
  "100kStatic":{ label:"$100k Static", startBalance:100000, minReqBalanceFirst3:102600 },
};
const MAX_PAYOUT_FIRST_FIVE = {
  "25k":1500,"50k":2000,"100k":2500,"150k":2750,"250k":3000,"300k":3500,"100kStatic":1000
};

const TRADING_RULES = [
  { key:"scaling", label:"Contract Scaling Rule", fix:"Confirm you followed the Contract Scaling Rule or address any violations." },
  { key:"mae", label:"30% Negative P&L Rule (MAE)", fix:"Confirm no single trade exceeded the 30% MAE limit." },
  { key:"risk", label:"5:1 Risk-Reward Ratio Rule", fix:"Confirm your stop loss did not exceed 5× your profit target." },
  { key:"hedge", label:"Hedging Rule", fix:"Confirm you did not hedge (long & short on the same/correlated instrument)." },
  { key:"direction", label:"One Direction Rule", fix:"Confirm you did not have conflicting long & short positions or orders." }
];

const RULE_LINKS = {
  scaling: "https://support.apextraderfunding.com/hc/en-us/articles/40463165052955-Contract-Scaling-Rule",
  mae: "https://support.apextraderfunding.com/hc/en-us/articles/40463232267035-30-Negative-P-L-Rule-Maximum-Adverse-Excursion-MAE",
  risk: "https://support.apextraderfunding.com/hc/en-us/articles/40463462503067-5-1-Risk-Reward-Ratio-Rule",
  hedge: "https://support.apextraderfunding.com/hc/en-us/articles/40463541656603-Hedging-and-Correlated-Instruments-Rule",
  direction: "https://support.apextraderfunding.com/hc/en-us/articles/40463473205275-One-Direction-Rule-Directionally-biased-trading"
};

const $ = s => document.querySelector(s);
const fmt = n => (n==null || Number.isNaN(n) ? "—" : Number(n).toLocaleString(undefined,{maximumFractionDigits:2}));
const num = s => {
  const v = Number(String(s||"").replace(/[^0-9.-]/g,""));
  return Number.isFinite(v) ? v : 0;
};
const clamp = (x,a,b)=>Math.max(a,Math.min(b,x));

/* ---------- Build Trading Rule Checkbox UI ---------- */
const rulesList = $("#rulesList");
rulesList.innerHTML = "";
TRADING_RULES.forEach(rule => {
  const li = document.createElement("li");
  li.style.justifyContent = "space-between";
  li.style.alignItems = "center";
  li.innerHTML = `
    <div style="display:flex;gap:8px;align-items:center;">
      <input type="checkbox" id="rule_${rule.key}" data-rule="${rule.key}" />
      <label for="rule_${rule.key}" style="cursor:pointer;font-weight:600">${rule.label}</label>
    </div>
    <a href="${RULE_LINKS[rule.key]}"
       target="_blank"
       style="font-size:12px;color:#60a5fa;text-decoration:none;">
       Learn more →
    </a>
  `;
  rulesList.appendChild(li);
});

/* ---------- Core evaluation (full logic + trading rules) ---------- */
function evaluate(inputs){
  const cfg = ACCOUNT_CONFIG[inputs.account];
  const payoutNum = clamp(Math.floor(inputs.payoutNumber||0),1,99);
  const minPayout = 500;

  const safetyNetRequired = !inputs.isLiveProp && payoutNum <= 3;
  const safetyNetAmount = cfg.minReqBalanceFirst3 - cfg.startBalance;
  const minBalanceToRequest = safetyNetRequired ? cfg.minReqBalanceFirst3 : cfg.startBalance + 100;

  const windfallRuleApplies = !inputs.isLiveProp && payoutNum < 6;
  const baseline = cfg.startBalance; // could be replaced with last approved payout balance if tracked
  const totalProfit = Math.max(0, inputs.currentBalance - baseline);
  const windfallPass = !windfallRuleApplies
    ? true
    : (totalProfit === 0
        ? false
        : (inputs.highestProfitDaySinceRef / totalProfit) <= 0.3);

  const eightDaysPass = inputs.tradingDaysSinceRef >= 8;
  const fiveDays50Pass = inputs.profitableDaysOver50SinceRef >= 5;

  const maxPayoutCap = payoutNum <= 5 ? (MAX_PAYOUT_FIRST_FIVE[inputs.account] ?? null) : null;

  const meetsMinBalance = inputs.currentBalance >= minBalanceToRequest;
  const canLeaveMinAfter = inputs.currentBalance - inputs.requestedPayout >= minBalanceToRequest;
  const meetsMinRequest = inputs.requestedPayout >= minPayout;
  const underMaxCap = (maxPayoutCap==null) ? true : inputs.requestedPayout <= maxPayoutCap;

  let safetyNetEncroachmentOK = true;
  if (safetyNetRequired){
    const overage = Math.max(0, inputs.requestedPayout - minPayout);
    const mustHave = cfg.minReqBalanceFirst3 + overage;
    safetyNetEncroachmentOK =
      inputs.requestedPayout === minPayout
        ? inputs.currentBalance >= cfg.minReqBalanceFirst3
        : inputs.currentBalance >= mustHave;
  }

  const paActive = inputs.paStatus === "Active";

  const reasons = [
    {
      pass: paActive,
      label: "Performance Account is active",
      detail: paActive ? "Account is in good standing." : `Status: ${inputs.paStatus}`
    },
    {
      pass: eightDaysPass,
      label: "≥ 8 trading days since last APPROVED payout (or start)",
      detail: `You have ${inputs.tradingDaysSinceRef} day(s).`
    },
    {
      pass: fiveDays50Pass,
      label: "≥ 5 days with ≥ $50 profit (in the same period)",
      detail: `You have ${inputs.profitableDaysOver50SinceRef} day(s).`
    },
    {
      pass: windfallPass,
      label: windfallRuleApplies
        ? "30% consistency rule met (no single day > 30% of total profit)"
        : "30% rule not in effect (≥ 6th payout or Live Prop)",
      detail: windfallRuleApplies
        ? `Highest day: $${fmt(inputs.highestProfitDaySinceRef)} | Total profit: $${fmt(totalProfit)} | Ratio: ${totalProfit>0?((inputs.highestProfitDaySinceRef/Math.max(1,totalProfit))*100).toFixed(1):"—"}%`
        : undefined
    },
    {
      pass: meetsMinBalance,
      label: safetyNetRequired
        ? `Meets safety net balance (≥ $${fmt(minBalanceToRequest)})`
        : `Meets trailing DD stop balance (≥ $${fmt(minBalanceToRequest)})`,
      detail: `Current balance: $${fmt(inputs.currentBalance)}`
    },
    {
      pass: meetsMinRequest,
      label: `Requested payout ≥ $${fmt(minPayout)}`
    },
    {
      pass: underMaxCap,
      label: maxPayoutCap==null
        ? "No max payout cap (≥ 6th payout)"
        : `Under max payout cap for this account & payout # (≤ $${fmt(maxPayoutCap)})`
    },
    {
      pass: safetyNetRequired ? safetyNetEncroachmentOK : canLeaveMinAfter,
      label: safetyNetRequired
        ? (inputs.requestedPayout===minPayout
            ? "Min $500 allowed even if ending encroaches safety net by $500"
            : "Balance exceeds safety net by amount over $500 requested")
        : "Sufficient balance remains after payout (≥ trailing stop)",
      detail: safetyNetRequired
        ? (inputs.requestedPayout===minPayout
            ? `Need ≥ $${fmt(minBalanceToRequest)} before request. Ending can be as low as $${fmt(minBalanceToRequest - 500)}.`
            : `For request of $${fmt(inputs.requestedPayout)}, need balance ≥ $${fmt(minBalanceToRequest + Math.max(0, inputs.requestedPayout - 500))}.`)
        : `Post-payout balance would be $${fmt(inputs.currentBalance - inputs.requestedPayout)}. Must be ≥ $${fmt(minBalanceToRequest)}.`
    },
  ];

  const advice = [];
  if (!eightDaysPass) advice.push("Trade more days until you hit 8 since the last approved payout.");
  if (!fiveDays50Pass) advice.push("You need at least 5 days with ≥ $50 profit in the same period.");
  if (windfallRuleApplies && !reasons[3].pass){
    advice.push(`Your highest day ($${fmt(inputs.highestProfitDaySinceRef)}) is >30% of total profit ($${fmt(totalProfit)}). Keep trading until total profit is at least $${fmt(Math.ceil(inputs.highestProfitDaySinceRef/0.3))}.`);
  }
  if (!reasons[4].pass){
    advice.push(
      safetyNetRequired
        ? `Build balance to at least $${fmt(minBalanceToRequest)} to satisfy the safety net.`
        : `Build balance to at least $${fmt(minBalanceToRequest)} (trailing DD stop).`
    );
  }
  if (maxPayoutCap!=null && !reasons[6].pass){
    advice.push(`Requested payout exceeds the max cap of $${fmt(maxPayoutCap)} for this payout number.`);
  }

  // Trading rules (checkboxes) are REQUIRED
  TRADING_RULES.forEach(rule => {
    const box = document.querySelector(`#rule_${rule.key}`);
    const checked = !!(box && box.checked);
    reasons.push({
      pass: checked,
      label: rule.label,
      detail: checked
        ? "You confirmed you followed this trading rule for this payout period."
        : "You must confirm you followed this rule before requesting payout."
    });
    if (!checked){
      advice.push(rule.fix);
    }
  });

  // Final eligibility
  const eligible = reasons.every(r=>r.pass);

  let payoutRangeAllowed = null;
  if (eligible){
    const minAllowed = 500;
    let byBalance = safetyNetRequired
      ? Math.max(500, 500 + Math.max(0, inputs.currentBalance - minBalanceToRequest))
      : inputs.currentBalance - minBalanceToRequest;
    let maxAllowed = Math.floor(byBalance);
    if (maxPayoutCap != null) maxAllowed = Math.min(maxAllowed, maxPayoutCap);
    if (maxAllowed >= minAllowed) payoutRangeAllowed = { min:minAllowed, max:maxAllowed };
  }

  return {
    eligible,
    reasons,
    advice,
    computed:{
      safetyNetRequired,
      safetyNetAmount,
      minBalanceToRequest,
      minPayout,
      maxPayoutCap: maxPayoutCap ?? null,
      mustLeaveAfterPayout: minBalanceToRequest,
      payoutRangeAllowed
    }
  };
}

/* ---------- Wire up UI ---------- */
const fields = {
  paStatus: $("#paStatus"),
  account: $("#account"),
  approvedCount: $("#approvedCount"),
  isLiveProp: $("#isLiveProp"),
  currentBalance: $("#currentBalance"),
  requestedPayout: $("#requestedPayout"),
  highestProfitDay: $("#highestProfitDay"),
  tradingDays: $("#tradingDays"),
  profitableDays: $("#profitableDays"),
  payoutStatus: $("#payoutStatus"),
  payoutStatusHelp: $("#payoutStatusHelp"),
};

const summary = {
  yesno: $("#yesno"),
  safetyReq: $("#safetyReq"),
  safetyAmt: $("#safetyAmt"),
  minBal: $("#minBal"),
  minPay: $("#minPay"),
  maxCap: $("#maxCap"),
  rangeWrap: $("#rangeWrap"),
  range: $("#range"),
  card: $("#summaryCard"),
  checklist: $("#checklist"),
  adviceWrap: $("#adviceWrap"),
  adviceList: $("#adviceList"),
};

function getInputs(){
  const approvedCount = Math.max(0, Math.floor(num(fields.approvedCount?.value)));
  const payoutNumber = Math.max(1, (approvedCount || 0) + 1);

  return {
    paStatus: fields.paStatus?.value || "Active",
    account: fields.account?.value || "50k",
    payoutNumber,
    isLiveProp: !!fields.isLiveProp?.checked,
    currentBalance: num(fields.currentBalance?.value),
    highestProfitDaySinceRef: num(fields.highestProfitDay?.value),
    tradingDaysSinceRef: Math.max(0, Math.floor(num(fields.tradingDays?.value))),
    profitableDaysOver50SinceRef: Math.max(0, Math.floor(num(fields.profitableDays?.value))),
    requestedPayout: num(fields.requestedPayout?.value),
  };
}

function render(){
  // update helper text for last payout status
  const val = fields.payoutStatus?.value || "none";
  if(val==="none"){
    fields.payoutStatusHelp.textContent = "All trading days since starting this PA count toward eligibility.";
  }else if(val==="denied"){
    fields.payoutStatusHelp.textContent = "If your last payout was denied, the 8-day count and the 5-day ≥ $50 requirement start the day after that denial.";
  }else{
    fields.payoutStatusHelp.textContent = "If your last payout was approved, the 8-day count and the 5-day ≥ $50 requirement start the day after that approval.";
  }

  const res = evaluate(getInputs());

  // summary YES/NO and card color
  summary.yesno.textContent = res.eligible ? "YES" : "NO";
  summary.yesno.className = res.eligible ? "ok" : "bad";
  summary.card.style.borderColor = res.eligible ? "#22c55e" : "#f43f5e";

  // summary numbers
  summary.safetyReq.textContent = res.computed.safetyNetRequired ? "Yes (first 3 payouts)" : "No";
  summary.safetyAmt.textContent = `$${fmt(res.computed.safetyNetAmount)}`;
  summary.minBal.textContent = `$${fmt(res.computed.minBalanceToRequest)}`;
  summary.minPay.textContent = `$${fmt(res.computed.minPayout)}`;
  summary.maxCap.textContent = res.computed.maxPayoutCap ? `$${fmt(res.computed.maxPayoutCap)}` : "No cap (≥6th)";

  if (res.computed.payoutRangeAllowed){
    summary.rangeWrap.style.display = "block";
    summary.range.textContent = `$${fmt(res.computed.payoutRangeAllowed.min)} – $${fmt(res.computed.payoutRangeAllowed.max)}`;
  } else {
    summary.rangeWrap.style.display = "none";
  }

  // checklist
  summary.checklist.innerHTML = "";
  res.reasons.forEach(r=>{
    const li = document.createElement("li");
    li.innerHTML = `
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none"
           stroke="${r.pass ? '#22c55e' : '#f43f5e'}" stroke-width="2" style="margin-top:2px">
        ${r.pass
          ? '<path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><path d="M22 4 12 14.01l-3-3"></path>'
          : '<circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line>'}
      </svg>
      <div>
        <div style="font-weight:600">${r.label}</div>
        ${r.detail ? `<div class="help">${r.detail}</div>` : ""}
      </div>`;
    summary.checklist.appendChild(li);
  });

  // advice (What to Fix)
  summary.adviceList.innerHTML = "";
  if (res.advice.length){
    summary.adviceWrap.style.display = "block";
    res.advice.forEach(a=>{
      const li = document.createElement("li");
      li.innerHTML = `<div class="help">${a}</div>`;
      summary.adviceList.appendChild(li);
    });
  } else {
    summary.adviceWrap.style.display = "none";
  }
}

// input listeners (including rule checkboxes)
document.querySelectorAll("input, select").forEach(el =>
  el.addEventListener("input", render)
);

render();

}); // DOMContentLoaded
</script>

</body>
</html>
